{"version":3,"file":"D1admUZu.js","names":[],"sources":["../../node_modules/libs/nuip/dist/runtime/components/content/ContentSearch.vue"],"sourcesContent":["<script>\nimport theme from \"#build/ui-pro/content/content-search\";\n</script>\n\n<script setup>\nimport { computed, useTemplateRef } from \"vue\";\nimport { useForwardProps } from \"reka-ui\";\nimport { defu } from \"defu\";\nimport { reactivePick } from \"@vueuse/core\";\nimport UModal from \"@nuxt/ui/components/Modal.vue\";\nimport UCommandPalette from \"@nuxt/ui/components/CommandPalette.vue\";\nimport { omit } from \"@nuxt/ui/utils\";\nimport { useAppConfig, useColorMode, defineShortcuts } from \"#imports\";\nimport { useContentSearch } from \"../../composables/useContentSearch\";\nimport { useLocalePro } from \"../../composables/useLocalePro\";\nimport { transformUI } from \"../../utils\";\nimport { tv } from \"../../utils/tv\";\nconst props = defineProps({\n  icon: { type: String, required: false },\n  placeholder: { type: null, required: false },\n  autofocus: { type: Boolean, required: false },\n  loading: { type: Boolean, required: false },\n  loadingIcon: { type: String, required: false },\n  close: { type: [Boolean, Object], required: false, default: true },\n  closeIcon: { type: String, required: false },\n  shortcut: { type: String, required: false, default: \"meta_k\" },\n  links: { type: Array, required: false },\n  navigation: { type: Array, required: false },\n  groups: { type: Array, required: false },\n  files: { type: Array, required: false },\n  fuse: { type: Object, required: false },\n  colorMode: { type: Boolean, required: false, default: true },\n  class: { type: null, required: false },\n  ui: { type: void 0, required: false }\n});\nconst slots = defineSlots();\nconst searchTerm = defineModel(\"searchTerm\", { type: String, ...{ default: \"\" } });\nconst { t } = useLocalePro();\nconst { open } = useContentSearch();\nconst colorMode = useColorMode();\nconst appConfig = useAppConfig();\nconst commandPaletteProps = useForwardProps(reactivePick(props, \"icon\", \"placeholder\", \"autofocus\", \"loading\", \"loadingIcon\", \"close\", \"closeIcon\"));\nconst proxySlots = omit(slots, [\"content\"]);\nconst fuse = computed(() => defu({}, props.fuse, {\n  fuseOptions: {\n    includeMatches: true\n  }\n}));\nconst ui = computed(() => tv({ extend: tv(theme), ...appConfig.uiPro?.contentSearch || {} })());\nfunction mapLinksItems(links) {\n  return links.flatMap((link) => [{\n    ...link,\n    suffix: link.description,\n    icon: link.icon || appConfig.ui.icons.file\n  }, ...link.children?.map((child) => ({\n    ...child,\n    prefix: link.label + \" >\",\n    suffix: child.description,\n    icon: child.icon || link.icon || appConfig.ui.icons.file\n  })) || []]);\n}\nfunction mapNavigationItems(children, parent) {\n  return children.flatMap((link) => {\n    if (link.children?.length) {\n      return mapNavigationItems(link.children, link);\n    }\n    return props.files?.filter((file) => file.id === link.path || file.id.startsWith(`${link.path}#`))?.map((file) => mapFile(file, link, parent)) || [];\n  });\n}\nfunction mapFile(file, link, parent) {\n  const prefix = [...new Set([parent?.title, ...file.titles].filter(Boolean))];\n  return {\n    prefix: prefix?.length ? prefix.join(\" > \") + \" >\" : void 0,\n    label: file.id === link.path ? link.title : file.title,\n    suffix: file.content.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\"),\n    to: file.id,\n    icon: link.icon || parent?.icon || (file.level > 1 ? appConfig.ui.icons.hash : appConfig.ui.icons.file),\n    level: file.level\n  };\n}\nconst groups = computed(() => {\n  const groups2 = [];\n  if (props.links?.length) {\n    groups2.push({ id: \"links\", label: t(\"contentSearch.links\"), items: mapLinksItems(props.links) });\n  }\n  if (props.navigation?.length) {\n    if (props.navigation.some((link) => !!link.children?.length)) {\n      groups2.push(...props.navigation.map((group) => ({ id: group.path, label: group.title, items: mapNavigationItems(group.children || []), postFilter })));\n    } else {\n      groups2.push({ id: \"docs\", items: mapNavigationItems(props.navigation), postFilter });\n    }\n  }\n  groups2.push(...props.groups || []);\n  if (props.colorMode && !colorMode?.forced) {\n    groups2.push({\n      id: \"theme\",\n      label: t(\"contentSearch.theme\"),\n      items: [{\n        label: t(\"colorMode.system\"),\n        icon: appConfig.ui.icons.system,\n        active: colorMode.preference === \"system\",\n        onSelect: () => {\n          colorMode.preference = \"system\";\n        }\n      }, {\n        label: t(\"colorMode.light\"),\n        icon: appConfig.ui.icons.light,\n        active: colorMode.preference === \"light\",\n        onSelect: () => {\n          colorMode.preference = \"light\";\n        }\n      }, {\n        label: t(\"colorMode.dark\"),\n        icon: appConfig.ui.icons.dark,\n        active: colorMode.preference === \"dark\",\n        onSelect: () => {\n          colorMode.preference = \"dark\";\n        }\n      }]\n    });\n  }\n  return groups2;\n});\nfunction postFilter(query, items) {\n  if (!query) {\n    return items?.filter((item) => item.level === 1);\n  }\n  return items;\n}\nfunction onSelect(item) {\n  if (item.disabled) {\n    return;\n  }\n  open.value = false;\n  searchTerm.value = \"\";\n}\ndefineShortcuts({\n  [props.shortcut]: {\n    usingInput: true,\n    handler: () => open.value = !open.value\n  }\n});\nconst commandPaletteRef = useTemplateRef(\"commandPaletteRef\");\ndefineExpose({\n  commandPaletteRef\n});\n</script>\n\n<template>\n  <UModal\n    v-model:open=\"open\"\n    :title=\"t('contentSearch.title')\"\n    :description=\"t('contentSearch.description')\"\n    :class=\"ui.modal({ class: [props.ui?.modal, props.class] })\"\n  >\n    <template #content>\n      <slot name=\"content\">\n        <UCommandPalette\n          ref=\"commandPaletteRef\"\n          v-model:search-term=\"searchTerm\"\n          v-bind=\"commandPaletteProps\"\n          :groups=\"groups\"\n          :fuse=\"fuse\"\n          :ui=\"transformUI(omit(ui, ['modal']), props.ui)\"\n          @update:model-value=\"onSelect\"\n          @update:open=\"open = $event\"\n        >\n          <template v-for=\"(_, name) in proxySlots\" #[name]=\"slotData\">\n            <slot :name=\"name\" v-bind=\"slotData\" />\n          </template>\n        </UCommandPalette>\n      </slot>\n    </template>\n  </UModal>\n</template>\n"],"mappings":"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"}