{"version":3,"file":"BM7x2gtW.js","names":["$attrs"],"sources":["../../node_modules/.cache/.pnpm/motion-v@1.7.1_@vueuse+core_e3d4d682e0f58aba3ca1802d16d58f7a/node_modules/motion-v/dist/es/components/animate-presence/use-pop-layout.mjs","../../node_modules/.cache/.pnpm/motion-v@1.7.1_@vueuse+core_e3d4d682e0f58aba3ca1802d16d58f7a/node_modules/motion-v/dist/es/utils/delay.mjs","../../node_modules/.cache/.pnpm/motion-v@1.7.1_@vueuse+core_e3d4d682e0f58aba3ca1802d16d58f7a/node_modules/motion-v/dist/es/components/animate-presence/AnimatePresence.vue.mjs","../../node_modules/libs/nuip/dist/runtime/components/prose/Img.vue"],"sourcesContent":["import { useMotionConfig } from \"../motion-config/context.mjs\";\nimport { frame } from \"../../external/.pnpm/motion-dom@12.23.12/external/motion-dom/dist/es/frameloop/frame.mjs\";\nfunction usePopLayout(props) {\n  const styles = /* @__PURE__ */ new WeakMap();\n  const config = useMotionConfig();\n  function addPopStyle(state) {\n    if (props.mode !== \"popLayout\")\n      return;\n    const element = state.element;\n    const parent = element.offsetParent;\n    const parentWidth = parent instanceof HTMLElement ? parent.offsetWidth || 0 : 0;\n    const size = {\n      height: element.offsetHeight || 0,\n      width: element.offsetWidth || 0,\n      top: element.offsetTop,\n      left: element.offsetLeft,\n      right: 0\n    };\n    size.right = parentWidth - size.width - size.left;\n    const x = props.anchorX === \"left\" ? `left: ${size.left}` : `right: ${size.right}`;\n    state.element.dataset.motionPopId = state.id;\n    const style = document.createElement(\"style\");\n    if (config.value.nonce) {\n      style.nonce = config.value.nonce;\n    }\n    styles.set(state, style);\n    document.head.appendChild(style);\n    if (style.sheet) {\n      style.sheet.insertRule(`\n    [data-motion-pop-id=\"${state.id}\"] {\n      position: absolute !important;\n      width: ${size.width}px !important;\n      height: ${size.height}px !important;\n      top: ${size.top}px !important;\n      ${x}px !important;\n      }\n      `);\n    }\n  }\n  function removePopStyle(state) {\n    const style = styles.get(state);\n    if (!style)\n      return;\n    styles.delete(state);\n    frame.render(() => {\n      document.head.removeChild(style);\n    });\n  }\n  return {\n    addPopStyle,\n    removePopStyle,\n    styles\n  };\n}\nexport {\n  usePopLayout\n};\n","function delay(fn) {\n  return Promise.resolve().then(() => {\n    fn();\n  });\n}\nexport {\n  delay\n};\n","import { defineComponent, onUnmounted, computed, openBlock, createBlock, resolveDynamicComponent, Transition, TransitionGroup, mergeProps, withCtx, renderSlot } from \"vue\";\nimport { mountedStates } from \"../../state/motion-state.mjs\";\nimport { useAnimatePresence, removeDoneCallback, doneCallbacks } from \"./presence.mjs\";\nimport { usePopLayout } from \"./use-pop-layout.mjs\";\nimport { delay } from \"../../utils/delay.mjs\";\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  ...{\n    name: \"AnimatePresence\",\n    inheritAttrs: true\n  },\n  __name: \"AnimatePresence\",\n  props: {\n    mode: { default: \"sync\" },\n    initial: { type: Boolean, default: true },\n    as: {},\n    custom: {},\n    onExitComplete: {},\n    anchorX: { default: \"left\" }\n  },\n  setup(__props) {\n    const props = __props;\n    useAnimatePresence(props);\n    const { addPopStyle, removePopStyle, styles } = usePopLayout(props);\n    function findMotionElement(el) {\n      let current = el;\n      while (current) {\n        if (mountedStates.get(current)) {\n          return current;\n        }\n        current = current.firstElementChild;\n      }\n      return null;\n    }\n    function enter(el) {\n      const state = mountedStates.get(el);\n      if (!state) {\n        return;\n      }\n      removePopStyle(state);\n      state.isVShow = true;\n      removeDoneCallback(el);\n      delay(() => {\n        state.setActive(\"exit\", false);\n      });\n    }\n    const exitDom = /* @__PURE__ */ new Map();\n    onUnmounted(() => {\n      exitDom.clear();\n    });\n    function exit(el, done) {\n      var _a;\n      const motionEl = findMotionElement(el);\n      const state = mountedStates.get(motionEl);\n      if (!motionEl || !state) {\n        done();\n        if (exitDom.size === 0) {\n          (_a = props.onExitComplete) == null ? void 0 : _a.call(props);\n        }\n        return;\n      }\n      exitDom.set(motionEl, true);\n      removeDoneCallback(motionEl);\n      addPopStyle(state);\n      function doneCallback(e) {\n        var _a2, _b;\n        if ((_a2 = e == null ? void 0 : e.detail) == null ? void 0 : _a2.isExit) {\n          const projection = state.visualElement.projection;\n          if ((projection == null ? void 0 : projection.animationProgress) > 0 && !state.isSafeToRemove && !state.isVShow) {\n            return;\n          }\n          removeDoneCallback(motionEl);\n          exitDom.delete(motionEl);\n          if (exitDom.size === 0) {\n            (_b = props.onExitComplete) == null ? void 0 : _b.call(props);\n          }\n          if (!styles.has(state)) {\n            state.willUpdate(\"done\");\n          } else {\n            removePopStyle(state);\n          }\n          done();\n          if (!motionEl.isConnected) {\n            state.unmount(true);\n          }\n        }\n      }\n      delay(() => {\n        state.setActive(\"exit\", true);\n        doneCallbacks.set(motionEl, doneCallback);\n        motionEl.addEventListener(\"motioncomplete\", doneCallback);\n      });\n    }\n    const transitionProps = computed(() => {\n      if (props.mode !== \"wait\") {\n        return {\n          tag: props.as\n        };\n      }\n      return {\n        mode: props.mode === \"wait\" ? \"out-in\" : void 0\n      };\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(resolveDynamicComponent(_ctx.mode === \"wait\" ? Transition : TransitionGroup), mergeProps({ css: false }, transitionProps.value, {\n        appear: \"\",\n        onEnter: enter,\n        onLeave: exit\n      }), {\n        default: withCtx(() => [\n          renderSlot(_ctx.$slots, \"default\")\n        ]),\n        _: 3\n      }, 16);\n    };\n  }\n});\nexport {\n  _sfc_main as default\n};\n","<script>\nimport theme from \"#build/ui-pro/prose/img\";\n</script>\n\n<script setup>\nimport { ref, computed, useId } from \"vue\";\nimport { withTrailingSlash, withLeadingSlash, joinURL } from \"ufo\";\nimport { DialogRoot, DialogPortal, DialogTrigger } from \"reka-ui\";\nimport { AnimatePresence, Motion } from \"motion-v\";\nimport { useEventListener, createReusableTemplate } from \"@vueuse/core\";\nimport { useRuntimeConfig, useAppConfig } from \"#imports\";\nimport ImageComponent from \"#build/ui-image-component\";\nimport { tv } from \"../../utils/tv\";\ndefineOptions({ inheritAttrs: false });\nconst props = defineProps({\n  src: { type: String, required: true },\n  alt: { type: String, required: true },\n  width: { type: [String, Number], required: false },\n  height: { type: [String, Number], required: false },\n  class: { type: null, required: false },\n  zoom: { type: Boolean, required: false, default: true },\n  ui: { type: null, required: false }\n});\nconst appConfig = useAppConfig();\nconst [DefineImageTemplate, ReuseImageTemplate] = createReusableTemplate();\nconst open = ref(false);\nconst ui = computed(() => tv({ extend: tv(theme), ...appConfig.uiPro?.prose?.img || {} })({\n  zoom: props.zoom,\n  open: open.value\n}));\nconst refinedSrc = computed(() => {\n  if (props.src?.startsWith(\"/\") && !props.src.startsWith(\"//\")) {\n    const _base = withLeadingSlash(withTrailingSlash(useRuntimeConfig().app.baseURL));\n    if (_base !== \"/\" && !props.src.startsWith(_base)) {\n      return joinURL(_base, props.src);\n    }\n  }\n  return props.src;\n});\nconst layoutId = computed(() => `${refinedSrc.value}::${useId()}`);\nif (props.zoom) {\n  useEventListener(window, \"scroll\", () => {\n    open.value = false;\n  });\n}\n</script>\n\n<template>\n  <DefineImageTemplate>\n    <component\n      :is=\"ImageComponent\"\n      :src=\"refinedSrc\"\n      :alt=\"alt\"\n      :width=\"width\"\n      :height=\"height\"\n      v-bind=\"$attrs\"\n      :class=\"ui.base({ class: [props.ui?.base, props.class] })\"\n    />\n  </DefineImageTemplate>\n\n  <DialogRoot v-if=\"zoom\" v-slot=\"{ close }\" v-model:open=\"open\" :modal=\"false\">\n    <DialogTrigger as-child>\n      <Motion :layout-id=\"layoutId\" as-child :transition=\"{ type: 'spring', bounce: 0.2, duration: 0.4 }\">\n        <ReuseImageTemplate />\n      </Motion>\n    </DialogTrigger>\n\n    <DialogPortal>\n      <AnimatePresence>\n        <Motion v-if=\"open\" :initial=\"{ opacity: 0 }\" :animate=\"{ opacity: 1 }\" :exit=\"{ opacity: 0 }\" :class=\"ui.overlay({ class: [props.ui?.overlay] })\" />\n\n        <div v-if=\"open\" :class=\"ui.content({ class: [props.ui?.content] })\" @click=\"close\">\n          <Motion as-child :layout-id=\"layoutId\" :transition=\"{ type: 'spring', bounce: 0.2, duration: 0.4 }\">\n            <ReuseImageTemplate />\n          </Motion>\n        </div>\n      </AnimatePresence>\n    </DialogPortal>\n  </DialogRoot>\n\n  <ReuseImageTemplate v-else />\n</template>\n"],"x_google_ignoreList":[0,1,2],"mappings":"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"}