import{$a as e,Ar as t,Ca as n,Ga as r,Hn as i,Ja as a,La as o,Ni as s,Or as c,Sn as l,Ta as u,Ua as d,Xa as f,Xn as p,_a as m,aa as h,da as g,dn as _,ja as v,ka as y,oa as b,po as x,ra as S,sa as C,so as w,ua as T,wa as E,xa as D,xo as O,yo as k,zr as A}from"#entry";import{t as j}from"./BfHrV45L.js";import"./pNx3PmFk.js";import{S as M,_ as N,b as P,r as F,t as I,v as L,y as R}from"./Cpz6Mn7z.js";function z(e){let t=new WeakMap,n=F();function r(r){if(e.mode!==`popLayout`)return;let i=r.element,a=i.offsetParent,o=a instanceof HTMLElement&&a.offsetWidth||0,s={height:i.offsetHeight||0,width:i.offsetWidth||0,top:i.offsetTop,left:i.offsetLeft,right:0};s.right=o-s.width-s.left;let c=e.anchorX===`left`?`left: ${s.left}`:`right: ${s.right}`;r.element.dataset.motionPopId=r.id;let l=document.createElement(`style`);n.value.nonce&&(l.nonce=n.value.nonce),t.set(r,l),document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`
    [data-motion-pop-id="${r.id}"] {
      position: absolute !important;
      width: ${s.width}px !important;
      height: ${s.height}px !important;
      top: ${s.top}px !important;
      ${c}px !important;
      }
      `)}function i(e){let n=t.get(e);n&&(t.delete(e),M.render(()=>{document.head.removeChild(n)}))}return{addPopStyle:r,removePopStyle:i,styles:t}}function B(e){return Promise.resolve().then(()=>{e()})}var V=v({name:`AnimatePresence`,inheritAttrs:!0,__name:`AnimatePresence`,props:{mode:{default:`sync`},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:`left`}},setup(e){let t=e;P(t);let{addPopStyle:i,removePopStyle:s,styles:c}=z(t);function l(e){let t=e;for(;t;){if(N.get(t))return t;t=t.firstElementChild}return null}function u(e){let t=N.get(e);t&&(s(t),t.isVShow=!0,R(e),B(()=>{t.setActive(`exit`,!1)}))}let p=new Map;d(()=>{p.clear()});function m(e,n){var r;let a=l(e),o=N.get(a);if(!a||!o){n(),p.size===0&&((r=t.onExitComplete)==null||r.call(t));return}p.set(a,!0),R(a),i(o);function u(e){var r;if(e?.detail?.isExit){if(o.visualElement.projection?.animationProgress>0&&!o.isSafeToRemove&&!o.isVShow)return;R(a),p.delete(a),p.size===0&&((r=t.onExitComplete)==null||r.call(t)),c.has(o)?s(o):o.willUpdate(`done`),n(),a.isConnected||o.unmount(!0)}}B(()=>{o.setActive(`exit`,!0),L.set(a,u),a.addEventListener(`motioncomplete`,u)})}let h=D(()=>t.mode===`wait`?{mode:t.mode===`wait`?`out-in`:void 0}:{tag:t.as});return(e,t)=>(r(),n(f(e.mode===`wait`?T:g),o({css:!1},h.value,{appear:``,onEnter:u,onLeave:m}),{default:w(()=>[a(e.$slots,`default`)]),_:3},16))}}),H=[`onClick`],U=Object.assign({inheritAttrs:!1},{__name:`ProseImg`,props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(a){let d=a,g=s(),[v,T]=i(),M=x(!1),N=D(()=>_({extend:_(j),...g.uiPro?.prose?.img||{}})({zoom:d.zoom,open:M.value})),P=D(()=>{if(d.src?.startsWith(`/`)&&!d.src.startsWith(`//`)){let e=b(C(S().app.baseURL));if(e!==`/`&&!d.src.startsWith(e))return h(e,d.src)}return d.src}),F=D(()=>`${P.value}::${e()}`);return d.zoom&&p(window,`scroll`,()=>{M.value=!1}),(e,i)=>(r(),u(m,null,[y(k(v),null,{default:w(()=>[(r(),n(f(k(l)),o({src:P.value,alt:a.alt,width:a.width,height:a.height},e.$attrs,{class:N.value.base({class:[d.ui?.base,d.class]})}),null,16,[`src`,`alt`,`width`,`height`,`class`]))]),_:1}),a.zoom?(r(),n(k(A),{key:0,open:M.value,"onUpdate:open":i[0]||=e=>M.value=e,modal:!1},{default:w(({close:e})=>[y(k(c),{"as-child":``},{default:w(()=>[y(k(I),{"layout-id":F.value,"as-child":``,transition:{type:`spring`,bounce:.2,duration:.4}},{default:w(()=>[y(k(T))]),_:1},8,[`layout-id`])]),_:1}),y(k(t),null,{default:w(()=>[y(k(V),null,{default:w(()=>[M.value?(r(),n(k(I),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:O(N.value.overlay({class:[d.ui?.overlay]}))},null,8,[`class`])):E(``,!0),M.value?(r(),u(`div`,{key:1,class:O(N.value.content({class:[d.ui?.content]})),onClick:e},[y(k(I),{"as-child":``,"layout-id":F.value,transition:{type:`spring`,bounce:.2,duration:.4}},{default:w(()=>[y(k(T))]),_:1},8,[`layout-id`])],10,H)):E(``,!0)]),_:2},1024)]),_:2},1024)]),_:1},8,[`open`])):(r(),n(k(T),{key:1}))],64))}});export{U as default};
//# sourceMappingURL=BM7x2gtW.js.map