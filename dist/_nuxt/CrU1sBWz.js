import{a as e,n as t,o as n,r,s as i,t as a}from"./0gl239Bx.js";import{n as o,t as s}from"./Bo70QARZ.js";import{$t as c,B as l,Ca as u,Ea as ee,Ga as d,Ia as f,Ja as p,L as te,La as m,N as h,Ni as ne,Oa as g,Qt as _,R as v,Sa as y,Ta as b,Wn as x,Xn as S,_a as C,ai as re,cn as ie,ea as ae,en as oe,eo as se,in as w,ir as T,it as E,ka as D,ma as ce,nn as O,no as le,oi as ue,po as k,qa as A,so as j,sr as M,tn as de,to as fe,vo as N,wa as P,wo as F,xa as I,xo as L,yo as R,z}from"#entry";import{t as B}from"./DyDKH_mR.js";import{t as pe}from"./VeSnrGk5.js";function V(e,t){let n=``,r=0,i=!1;for(let a=e.length-1;a>=0;a--){if(e[a]===`>`)i=!0;else if(e[a]===`<`){i=!1,n=e[a]+n;continue}if(i||r++,r<=t)n=e[a]+n;else{n=`...`+n;break}}return n}function H(e,t,n,r){function i(e,n=[]){e||=``;let r=``,i=0;n.forEach(n=>{if(n.length===2&&n[0]===n[1])return;let a=n[1]+1,o=a-n[0]>=t.length;r+=[e.substring(i,n[0]),o&&`<mark>`,e.substring(n[0],a),o&&`</mark>`].filter(Boolean).join(``),i=a}),r+=e.substring(i);let a=r.indexOf(`<mark>`);return a!==-1&&(r=V(r,r.length-a)),r}if(e.matches?.length)for(let t of e.matches){if(n&&t.key!==n||r?.includes(t.key))continue;return i(t.value,t.indices)}}var me=[`innerHTML`],he=[`innerHTML`],U={__name:`CommandPalette`,props:f({as:{type:null,required:!1},icon:{type:String,required:!1},selectedIcon:{type:String,required:!1},trailingIcon:{type:String,required:!1},placeholder:{type:String,required:!1},autofocus:{type:Boolean,required:!1,default:!0},close:{type:[Boolean,Object],required:!1},closeIcon:{type:String,required:!1},back:{type:[Boolean,Object],required:!1,default:!0},backIcon:{type:String,required:!1},groups:{type:Array,required:!1},fuse:{type:Object,required:!1},labelKey:{type:String,required:!1,default:`label`},class:{type:null,required:!1},ui:{type:null,required:!1},multiple:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},modelValue:{type:null,required:!1,default:``},defaultValue:{type:null,required:!1},highlightOnHover:{type:Boolean,required:!1},selectionBehavior:{type:String,required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:String,required:!1}},{searchTerm:{type:String,default:``},searchTermModifiers:{}}),emits:f([`update:modelValue`,`highlight`,`entryFocus`,`leave`,`update:open`],[`update:searchTerm`]),setup(f,{emit:x}){let S=f,E=x,M=fe(),N=se(f,`searchTerm`,{type:String,default:``}),{t:V}=h(),U=ne(),W=re(T(S,`as`,`disabled`,`multiple`,`modelValue`,`defaultValue`,`highlightOnHover`,`selectionBehavior`),E),G=ue(T(S,`loading`,`loadingIcon`)),K=I(()=>O({extend:O(B),...U.ui?.commandPalette||{}})()),q=I(()=>ae({},S.fuse,{fuseOptions:{ignoreLocation:!0,threshold:.1,keys:[S.labelKey,`suffix`]},resultLimit:12,matchAllWhenSearchEmpty:!0})),J=k([]),ge=I(()=>J.value[J.value.length-1]?.placeholder||S.placeholder||V(`commandPalette.placeholder`)),Y=I(()=>J.value?.length?[J.value[J.value.length-1]]:S.groups),_e=I(()=>Y.value?.filter(e=>e.id?!e.ignoreFilter:(console.warn("[@nuxt/ui] CommandPalette group is missing an `id` property"),!1))?.flatMap(e=>e.items?.map(t=>({...t,group:e.id}))||[])||[]),{results:ve}=s(N,_e,q);function X(e,t){return e?.postFilter&&typeof e.postFilter==`function`&&(t=e.postFilter(N.value,t)),{...e,items:t.slice(0,q.value.resultLimit).map(e=>({...e,labelHtml:H(e,N.value,S.labelKey),suffixHtml:H(e,N.value,void 0,[S.labelKey])}))}}let Z=I(()=>{let e=ve.value.reduce((e,t)=>{let{item:n,matches:r}=t;return n.group?(e[n.group]||=[],e[n.group]?.push({...n,matches:r}),e):e},{}),t=Object.entries(e).map(([e,t])=>{let n=Y.value?.find(t=>t.id===e);if(n)return X(n,t)}).filter(e=>!!e);return(Y.value?.map((e,t)=>({...e,index:t}))?.filter(e=>e.ignoreFilter&&e.items?.length)?.map(e=>({...X(e,e.items||[]),index:e.index}))||[]).reduce((e,t)=>(e.splice(t.index,0,t),e),[...t])}),Q=le(`listboxRootRef`);function ye(e){e.children?.length&&(J.value.push({id:`history-${J.value.length}`,label:e.label,slot:e.slot,placeholder:e.placeholder,items:e.children}),N.value=``,Q.value?.highlightFirstItem())}function $(){J.value.length&&(J.value.pop(),N.value=``,Q.value?.highlightFirstItem())}function be(){N.value||$()}function xe(e,t){t.children?.length?(e.preventDefault(),ye(t)):t.onSelect?.(e)}return(s,h)=>(d(),u(R(i),m(R(W),{ref_key:`listboxRootRef`,ref:Q,class:K.value.root({class:[S.ui?.root,S.class]})}),{default:j(()=>[D(R(e),{modelValue:N.value,"onUpdate:modelValue":h[1]||=e=>N.value=e,"as-child":``},{default:j(()=>[D(pe,m({placeholder:ge.value,variant:`none`,autofocus:f.autofocus},R(G),{icon:f.icon||R(U).ui.icons.search,class:K.value.input({class:S.ui?.input}),onKeydown:ce(be,[`backspace`])}),ee({_:2},[J.value?.length&&(f.back||M.back)?{name:`leading`,fn:j(()=>[p(s.$slots,`back`,{ui:K.value},()=>[D(v,m({icon:f.backIcon||R(U).ui.icons.arrowLeft,color:`neutral`,variant:`link`,"aria-label":R(V)(`commandPalette.back`)},typeof f.back==`object`?f.back:{},{class:K.value.back({class:S.ui?.back}),onClick:$}),null,16,[`icon`,`aria-label`,`class`])])]),key:`0`}:void 0,f.close||M.close?{name:`trailing`,fn:j(()=>[p(s.$slots,`close`,{ui:K.value},()=>[f.close?(d(),u(v,m({key:0,icon:f.closeIcon||R(U).ui.icons.close,color:`neutral`,variant:`ghost`,"aria-label":R(V)(`commandPalette.close`)},typeof f.close==`object`?f.close:{},{class:K.value.close({class:S.ui?.close}),onClick:h[0]||=e=>E(`update:open`,!1)}),null,16,[`icon`,`aria-label`,`class`])):P(``,!0)])]),key:`1`}:void 0]),1040,[`placeholder`,`autofocus`,`icon`,`class`])]),_:3},8,[`modelValue`]),D(R(n),{class:L(K.value.content({class:S.ui?.content}))},{default:j(()=>[Z.value?.length?(d(),b(`div`,{key:0,role:`presentation`,class:L(K.value.viewport({class:S.ui?.viewport}))},[(d(!0),b(C,null,A(Z.value,e=>(d(),u(R(r),{key:`group-${e.id}`,class:L(K.value.group({class:S.ui?.group}))},{default:j(()=>[R(w)(e,S.labelKey)?(d(),u(R(o),{key:0,class:L(K.value.label({class:S.ui?.label}))},{default:j(()=>[g(F(R(w)(e,S.labelKey)),1)]),_:2},1032,[`class`])):P(``,!0),(d(!0),b(C,null,A(e.items,(n,r)=>(d(),u(R(t),{key:`group-${e.id}-${r}`,value:R(ie)(n,[`matches`,`group`,`onSelect`,`labelHtml`,`suffixHtml`,`children`]),disabled:n.disabled,"as-child":``,onSelect:e=>xe(e,n)},{default:j(()=>[D(c,m({ref_for:!0},R(de)(n),{custom:``}),{default:j(({active:t,...i})=>[D(oe,m({ref_for:!0},i,{class:K.value.item({class:[S.ui?.item,n.ui?.item,n.class],active:t||n.active})}),{default:j(()=>[p(s.$slots,n.slot||e.slot||`item`,{item:n,index:r},()=>[p(s.$slots,n.slot?`${n.slot}-leading`:e.slot?`${e.slot}-leading`:`item-leading`,{item:n,index:r},()=>[n.loading?(d(),u(_,{key:0,name:f.loadingIcon||R(U).ui.icons.loading,class:L(K.value.itemLeadingIcon({class:[S.ui?.itemLeadingIcon,n.ui?.itemLeadingIcon],loading:!0}))},null,8,[`name`,`class`])):n.icon?(d(),u(_,{key:1,name:n.icon,class:L(K.value.itemLeadingIcon({class:[S.ui?.itemLeadingIcon,n.ui?.itemLeadingIcon],active:t||n.active}))},null,8,[`name`,`class`])):n.avatar?(d(),u(z,m({key:2,size:n.ui?.itemLeadingAvatarSize||S.ui?.itemLeadingAvatarSize||K.value.itemLeadingAvatarSize()},{ref_for:!0},n.avatar,{class:K.value.itemLeadingAvatar({class:[S.ui?.itemLeadingAvatar,n.ui?.itemLeadingAvatar],active:t||n.active})}),null,16,[`size`,`class`])):n.chip?(d(),u(l,m({key:3,size:n.ui?.itemLeadingChipSize||S.ui?.itemLeadingChipSize||K.value.itemLeadingChipSize(),inset:``,standalone:``},{ref_for:!0},n.chip,{class:K.value.itemLeadingChip({class:[S.ui?.itemLeadingChip,n.ui?.itemLeadingChip],active:t||n.active})}),null,16,[`size`,`class`])):P(``,!0)]),n.labelHtml||R(w)(n,S.labelKey)||M[n.slot?`${n.slot}-label`:e.slot?`${e.slot}-label`:`item-label`]?(d(),b(`span`,{key:0,class:L(K.value.itemLabel({class:[S.ui?.itemLabel,n.ui?.itemLabel],active:t||n.active}))},[p(s.$slots,n.slot?`${n.slot}-label`:e.slot?`${e.slot}-label`:`item-label`,{item:n,index:r},()=>[n.prefix?(d(),b(`span`,{key:0,class:L(K.value.itemLabelPrefix({class:[S.ui?.itemLabelPrefix,n.ui?.itemLabelPrefix]}))},F(n.prefix),3)):P(``,!0),y(`span`,{class:L(K.value.itemLabelBase({class:[S.ui?.itemLabelBase,n.ui?.itemLabelBase],active:t||n.active})),innerHTML:n.labelHtml||R(w)(n,S.labelKey)},null,10,me),y(`span`,{class:L(K.value.itemLabelSuffix({class:[S.ui?.itemLabelSuffix,n.ui?.itemLabelSuffix],active:t||n.active})),innerHTML:n.suffixHtml||n.suffix},null,10,he)])],2)):P(``,!0),y(`span`,{class:L(K.value.itemTrailing({class:[S.ui?.itemTrailing,n.ui?.itemTrailing]}))},[p(s.$slots,n.slot?`${n.slot}-trailing`:e.slot?`${e.slot}-trailing`:`item-trailing`,{item:n,index:r},()=>[n.children&&n.children.length>0?(d(),u(_,{key:0,name:f.trailingIcon||R(U).ui.icons.chevronRight,class:L(K.value.itemTrailingIcon({class:[S.ui?.itemTrailingIcon,n.ui?.itemTrailingIcon]}))},null,8,[`name`,`class`])):n.kbds?.length?(d(),b(`span`,{key:1,class:L(K.value.itemTrailingKbds({class:[S.ui?.itemTrailingKbds,n.ui?.itemTrailingKbds]}))},[(d(!0),b(C,null,A(n.kbds,(e,t)=>(d(),u(te,m({key:t,size:n.ui?.itemTrailingKbdsSize||S.ui?.itemTrailingKbdsSize||K.value.itemTrailingKbdsSize()},{ref_for:!0},typeof e==`string`?{value:e}:e),null,16,[`size`]))),128))],2)):e.highlightedIcon?(d(),u(_,{key:2,name:e.highlightedIcon,class:L(K.value.itemTrailingHighlightedIcon({class:[S.ui?.itemTrailingHighlightedIcon,n.ui?.itemTrailingHighlightedIcon]}))},null,8,[`name`,`class`])):P(``,!0)]),n.children?.length?P(``,!0):(d(),u(R(a),{key:0,"as-child":``},{default:j(()=>[D(_,{name:f.selectedIcon||R(U).ui.icons.check,class:L(K.value.itemTrailingIcon({class:[S.ui?.itemTrailingIcon,n.ui?.itemTrailingIcon]}))},null,8,[`name`,`class`])]),_:2},1024))],2)])]),_:2},1040,[`class`])]),_:2},1040)]),_:2},1032,[`value`,`disabled`,`onSelect`]))),128))]),_:2},1032,[`class`]))),128))],2)):(d(),b(`div`,{key:1,class:L(K.value.empty({class:S.ui?.empty}))},[p(s.$slots,`empty`,{searchTerm:N.value},()=>[g(F(N.value?R(V)(`commandPalette.noMatch`,{searchTerm:N.value}):R(V)(`commandPalette.noData`)),1)])],2))]),_:3},8,[`class`]),M.footer?(d(),b(`div`,{key:0,class:L(K.value.footer({class:S.ui?.footer}))},[p(s.$slots,`footer`,{ui:K.value})],2)):P(``,!0)]),_:3},16,[`class`]))}},W=/^[^-]+.*-.*[^-]+$/,G=/^[^_]+.*_.*[^_]+$/,K=[`arrowleft`,`arrowright`,`arrowup`,`arrowright`,`tab`,`escape`,`enter`,`backspace`];function q(e,t={}){let n=k([]),r=()=>{n.value.splice(0,n.value.length)},i=M(r,t.chainDelay??800),{macOS:a}=E(),o=x(),s=e=>{if(!e.key)return;let t=/^[a-z]{1}$/i.test(e.key),a=K.includes(e.key.toLowerCase()),o;if(n.value.push(e.key),n.value.length>=2){o=n.value.slice(-2).join(`-`);for(let t of l.value.filter(e=>e.chained)){if(t.key!==o)continue;t.enabled&&(e.preventDefault(),t.handler(e)),r();return}}for(let n of l.value.filter(e=>!e.chained)){if(e.key.toLowerCase()!==n.key||e.metaKey!==n.metaKey||e.ctrlKey!==n.ctrlKey||(t||a)&&e.shiftKey!==n.shiftKey)continue;n.enabled&&(e.preventDefault(),n.handler(e)),r();return}i()},c=I(()=>{let e=o.value?.tagName,t=o.value?.contentEditable;return e===`INPUT`||e===`TEXTAREA`||t===`true`||t===`plaintext-only`?o.value?.name||!0:!1}),l=I(()=>Object.entries(N(e)).map(([e,t])=>{if(!t)return null;let n;e.includes(`-`)&&e!==`-`&&!e.includes(`_`)&&!e.match(W)?.length&&console.trace(`[Shortcut] Invalid key: "${e}"`),e.includes(`_`)&&e!==`_`&&!e.match(G)?.length&&console.trace(`[Shortcut] Invalid key: "${e}"`);let r=e.includes(`-`)&&e!==`-`&&!e.includes(`_`);if(r)n={key:e.toLowerCase(),metaKey:!1,ctrlKey:!1,shiftKey:!1,altKey:!1};else{let t=e.toLowerCase().split(`_`).map(e=>e);n={key:t.filter(e=>![`meta`,`command`,`ctrl`,`shift`,`alt`,`option`].includes(e)).join(`_`),metaKey:t.includes(`meta`)||t.includes(`command`),ctrlKey:t.includes(`ctrl`),shiftKey:t.includes(`shift`),altKey:t.includes(`alt`)||t.includes(`option`)}}if(n.chained=r,!a.value&&n.metaKey&&!n.ctrlKey&&(n.metaKey=!1,n.ctrlKey=!0),typeof t==`function`?n.handler=t:typeof t==`object`&&(n={...n,handler:t.handler}),!n.handler)return console.trace(`[Shortcut] Invalid value`),null;let i=!0;return t.usingInput?typeof t.usingInput==`string`&&(i=c.value===t.usingInput):i=!c.value,n.enabled=i,n}).filter(Boolean));return S(`keydown`,s)}export{U as n,q as t};
//# sourceMappingURL=CrU1sBWz.js.map