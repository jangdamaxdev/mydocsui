import{Bt as e,Ca as t,Cn as n,En as r,Ga as i,Ha as a,Hn as o,Ia as s,Ja as c,Kn as l,La as u,Ni as d,Oa as f,Sa as p,Ta as m,Vn as h,Xa as g,Xr as _,Zn as v,_a as y,_n as b,do as x,eo as ee,fn as te,ha as S,ka as C,ma as w,po as T,qa as E,ro as D,so as O,to as k,wa as A,wo as j,xa as M,xo as N,yo as P}from"#entry";import{t as ne}from"./C7lO0SKm.js";function F(e){if(!e||e===`*`)return;let t=e.split(`,`).map(e=>{let t=e.trim();return t.includes(`/`)&&t.endsWith(`/*`)&&t.split(`/`)[0]||t}).filter(e=>!e.startsWith(`.`));return t.length>0?t:void 0}function re(e){let{accept:t=`*`,reset:n=!1,multiple:r=!1,dropzone:i=!0,onUpdate:o}=e,s=T(),c=T(),u=M(()=>F(P(t))),d=e=>{!e||e.length===0||(e instanceof FileList&&(e=Array.from(e)),e.length>1&&!r&&(e=[e[0]]),o(e))},f=T(!1),p=x({open:()=>{}});function m(){p.open()}return a(()=>{let{isOverDropZone:e}=i?l(c,{dataTypes:u.value,onDrop:d}):{isOverDropZone:T(!1)};D(e,e=>{f.value=e});let{onChange:a,open:o}=v({accept:P(t),multiple:r,input:P(s),reset:n});p.open=o,a(e=>d(e))}),{isDragging:f,open:m,inputRef:s,dropzoneRef:c}}var ie=[`id`,`name`,`accept`,`multiple`,`required`,`disabled`],I=Object.assign({inheritAttrs:!1},{__name:`UFileUpload`,props:s({as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},icon:{type:String,required:!1},label:{type:String,required:!1},description:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},layout:{type:null,required:!1,default:`grid`},position:{type:null,required:!1,default:`outside`},highlight:{type:Boolean,required:!1},accept:{type:String,required:!1,default:`*`},multiple:{type:Boolean,required:!1,default:!1},reset:{type:Boolean,required:!1,default:!1},dropzone:{type:Boolean,required:!1,default:!0},interactive:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},fileIcon:{type:String,required:!1},fileDelete:{type:[Boolean,Object],required:!1},fileDeleteIcon:{type:String,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},{modelValue:{type:null},modelModifiers:{}}),emits:s([`change`],[`update:modelValue`]),setup(a,{expose:s,emit:l}){let v=a,x=l,T=k(),F=ee(a,`modelValue`),I=d(),{t:ae}=e(),[L,R]=o(),{isDragging:z,open:B,inputRef:V,dropzoneRef:H}=re({accept:v.accept,reset:v.reset,multiple:v.multiple,dropzone:v.dropzone,onUpdate:Q}),{emitFormInput:U,emitFormChange:W,id:G,name:K,disabled:q,ariaAttrs:oe}=h(v),J=M(()=>v.multiple?`area`:v.variant),Y=M(()=>v.variant===`button`&&!v.multiple?`grid`:v.layout),X=M(()=>Y.value===`grid`&&v.multiple?`inside`:J.value===`button`?`outside`:v.position),Z=M(()=>r({extend:r(ne),...I.ui?.fileUpload||{}})({dropzone:v.dropzone,interactive:v.interactive,color:v.color,size:v.size,variant:J.value,layout:Y.value,position:X.value,multiple:v.multiple,highlight:v.highlight,disabled:v.disabled}));function se(e){return URL.createObjectURL(e)}function ce(e){if(e===0)return`0B`;let t=1024,n=[`B`,`KB`,`MB`,`GB`],r=Math.floor(Math.log(e)/Math.log(t)),i=e/t**+r;return`${r===0?i.toString():i.toFixed(0)}${n[r]}`}function Q(e,t=!1){v.multiple?t?F.value=e:F.value=[...F.value||[],...e||[]]:F.value=e?.[0];let n=new Event(`change`,{target:{value:F.value}});x(`change`,n),W(),U()}function $(e){if(!F.value)return;if(!v.multiple||e===void 0){Q([],!0),H.value?.focus();return}let t=[...F.value];t.splice(e,1),Q(t,!0),H.value?.focus()}return D(F,e=>{(!Array.isArray(e)||!e.length)&&V.value&&(V.value.value=``)}),s({inputRef:V,dropzoneRef:H}),(e,r)=>(i(),m(y,null,[C(P(L),null,{default:O(()=>[F.value&&(!Array.isArray(F.value)||F.value.length)?(i(),m(y,{key:0},[c(e.$slots,`files-top`,{files:F.value,open:P(B),removeFile:$}),p(`div`,{class:N(Z.value.files({class:v.ui?.files}))},[c(e.$slots,`files`,{files:F.value},()=>[(i(!0),m(y,null,E(Array.isArray(F.value)?F.value:[F.value],(t,n)=>(i(),m(`div`,{key:t.name,class:N(Z.value.file({class:v.ui?.file}))},[c(e.$slots,`file`,{file:t,index:n},()=>[c(e.$slots,`file-leading`,{file:t,index:n},()=>[C(b,{src:se(t),icon:a.fileIcon||P(I).ui.icons.file,size:v.size,class:N(Z.value.fileLeadingAvatar({class:v.ui?.fileLeadingAvatar}))},null,8,[`src`,`icon`,`size`,`class`])]),p(`div`,{class:N(Z.value.fileWrapper({class:v.ui?.fileWrapper}))},[p(`span`,{class:N(Z.value.fileName({class:v.ui?.fileName}))},[c(e.$slots,`file-name`,{file:t,index:n},()=>[f(j(t.name),1)])],2),p(`span`,{class:N(Z.value.fileSize({class:v.ui?.fileSize}))},[c(e.$slots,`file-size`,{file:t,index:n},()=>[f(j(ce(t.size)),1)])],2)],2),c(e.$slots,`file-trailing`,{file:t,index:n},()=>[C(te,u({color:`neutral`},{ref_for:!0},{...Y.value===`grid`?{variant:`solid`,size:`xs`}:{variant:`link`,size:a.size},...typeof a.fileDelete==`object`?a.fileDelete:void 0},{"aria-label":P(ae)(`fileUpload.removeFile`,{filename:t.name}),"trailing-icon":a.fileDeleteIcon||P(I).ui.icons.close,class:Z.value.fileTrailingButton({class:v.ui?.fileTrailingButton}),onClick:S(e=>$(n),[`stop`,`prevent`])}),null,16,[`aria-label`,`trailing-icon`,`class`,`onClick`])])])],2))),128))])],2),c(e.$slots,`files-bottom`,{files:F.value,open:P(B),removeFile:$})],64)):A(``,!0)]),_:3}),C(P(_),{as:a.as,class:N(Z.value.root({class:[v.ui?.root,v.class]}))},{default:O(()=>[c(e.$slots,`default`,{open:P(B),removeFile:$},()=>[(i(),t(g(J.value===`button`?`button`:`div`),{ref_key:`dropzoneRef`,ref:H,type:J.value===`button`?`button`:void 0,role:J.value===`button`?void 0:`button`,"data-dragging":P(z),class:N(Z.value.base({class:v.ui?.base})),tabindex:a.interactive&&!P(q)?0:-1,onClick:r[0]||=e=>a.interactive&&!P(q)&&P(B)(),onKeydown:r[1]||=S(()=>{},[`prevent`]),onKeyup:r[2]||=w(e=>a.interactive&&!P(q)&&P(B)(),[`enter`,`space`])},{default:O(()=>[X.value===`inside`?(i(),t(P(R),{key:0})):A(``,!0),X.value!==`inside`||(a.multiple?!F.value?.length:!F.value)?(i(),m(`div`,{key:1,class:N(Z.value.wrapper({class:v.ui?.wrapper}))},[c(e.$slots,`leading`,{},()=>[J.value===`button`?(i(),t(n,{key:0,name:a.icon||P(I).ui.icons.upload,class:N(Z.value.icon({class:v.ui?.icon}))},null,8,[`name`,`class`])):(i(),t(b,{key:1,icon:a.icon||P(I).ui.icons.upload,size:v.size,class:N(Z.value.avatar({class:v.ui?.avatar}))},null,8,[`icon`,`size`,`class`]))]),J.value===`button`?A(``,!0):(i(),m(y,{key:0},[a.label||T.label?(i(),m(`div`,{key:0,class:N(Z.value.label({class:v.ui?.label}))},[c(e.$slots,`label`,{},()=>[f(j(a.label),1)])],2)):A(``,!0),a.description||T.description?(i(),m(`div`,{key:1,class:N(Z.value.description({class:v.ui?.description}))},[c(e.$slots,`description`,{},()=>[f(j(a.description),1)])],2)):A(``,!0),T.actions?(i(),m(`div`,{key:2,class:N(Z.value.actions({class:v.ui?.actions}))},[c(e.$slots,`actions`,{files:F.value,open:P(B),removeFile:$})],2)):A(``,!0)],64))],2)):A(``,!0)]),_:3},40,[`type`,`role`,`data-dragging`,`class`,`tabindex`])),X.value===`outside`?(i(),t(P(R),{key:0})):A(``,!0)]),p(`input`,u({id:P(G),ref_key:`inputRef`,ref:V,type:`file`,name:P(K),accept:a.accept,multiple:a.multiple,required:a.required,disabled:P(q)},{...e.$attrs,...P(oe)},{class:`sr-only`,tabindex:`-1`}),null,16,ie)]),_:3},8,[`as`,`class`])],64))}});export{I as default};
//# sourceMappingURL=Bh3BZTh9.js.map