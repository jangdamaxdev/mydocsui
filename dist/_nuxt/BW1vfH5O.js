import"./XrRa3LO0.js";import"./B4R0nvBE.js";import"./-4LthkDL.js";import{a as e,n as t,o as n,r,s as i,t as a}from"./0gl239Bx.js";import{n as o,t as s}from"./Bo70QARZ.js";import{Bt as c,Ca as l,Cn as u,Ea as ee,En as d,Ga as f,Ia as p,Ja as m,La as h,Mn as te,Ni as ne,Oa as g,On as _,Sa as v,Ta as y,Tn as re,_a as b,_n as ie,ai as ae,ea as oe,eo as x,fn as S,gn as C,ir as w,ka as T,ma as se,mn as ce,no as le,nt as ue,oi as E,po as D,qa as O,so as k,to as de,wa as A,wo as j,xa as M,xo as N,yn as fe,yo as P}from"#entry";import"./CKe8ToaS.js";import{t as pe}from"./RY8z3lkP.js";import{t as F}from"./DyDKH_mR.js";import"./B_HPZwFe.js";function I(e,t){let n=``,r=0,i=!1;for(let a=e.length-1;a>=0;a--){if(e[a]===`>`)i=!0;else if(e[a]===`<`){i=!1,n=e[a]+n;continue}if(i||r++,r<=t)n=e[a]+n;else{n=`...`+n;break}}return n}function L(e,t,n,r){function i(e,n=[]){e||=``;let r=``,i=0;n.forEach(n=>{if(n.length===2&&n[0]===n[1])return;let a=n[1]+1,o=a-n[0]>=t.length;r+=[e.substring(i,n[0]),o&&`<mark>`,e.substring(n[0],a),o&&`</mark>`].filter(Boolean).join(``),i=a}),r+=e.substring(i);let a=r.indexOf(`<mark>`);return a!==-1&&(r=I(r,r.length-a)),r}if(e.matches?.length)for(let t of e.matches){if(n&&t.key!==n||r?.includes(t.key))continue;return i(t.value,t.indices)}}var R=[`innerHTML`],z=[`innerHTML`],B={__name:`UCommandPalette`,props:p({as:{type:null,required:!1},icon:{type:String,required:!1},selectedIcon:{type:String,required:!1},trailingIcon:{type:String,required:!1},placeholder:{type:String,required:!1},autofocus:{type:Boolean,required:!1,default:!0},close:{type:[Boolean,Object],required:!1},closeIcon:{type:String,required:!1},back:{type:[Boolean,Object],required:!1,default:!0},backIcon:{type:String,required:!1},groups:{type:Array,required:!1},fuse:{type:Object,required:!1},labelKey:{type:String,required:!1,default:`label`},class:{type:null,required:!1},ui:{type:null,required:!1},multiple:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},modelValue:{type:null,required:!1,default:``},defaultValue:{type:null,required:!1},highlightOnHover:{type:Boolean,required:!1},selectionBehavior:{type:String,required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:String,required:!1}},{searchTerm:{type:String,default:``},searchTermModifiers:{}}),emits:p([`update:modelValue`,`highlight`,`entryFocus`,`leave`,`update:open`],[`update:searchTerm`]),setup(p,{emit:I}){let B=p,V=I,H=de(),U=x(p,`searchTerm`,{type:String,default:``}),{t:W}=c(),G=ne(),me=ae(w(B,`as`,`disabled`,`multiple`,`modelValue`,`defaultValue`,`highlightOnHover`,`selectionBehavior`),V),he=E(w(B,`loading`,`loadingIcon`)),K=M(()=>d({extend:d(F),...G.ui?.commandPalette||{}})()),q=M(()=>oe({},B.fuse,{fuseOptions:{ignoreLocation:!0,threshold:.1,keys:[B.labelKey,`suffix`]},resultLimit:12,matchAllWhenSearchEmpty:!0})),J=D([]),ge=M(()=>J.value[J.value.length-1]?.placeholder||B.placeholder||W(`commandPalette.placeholder`)),Y=M(()=>J.value?.length?[J.value[J.value.length-1]]:B.groups),_e=M(()=>Y.value?.filter(e=>e.id?!e.ignoreFilter:(console.warn("[@nuxt/ui] CommandPalette group is missing an `id` property"),!1))?.flatMap(e=>e.items?.map(t=>({...t,group:e.id}))||[])||[]),{results:ve}=s(U,_e,q);function X(e,t){return e?.postFilter&&typeof e.postFilter==`function`&&(t=e.postFilter(U.value,t)),{...e,items:t.slice(0,q.value.resultLimit).map(e=>({...e,labelHtml:L(e,U.value,B.labelKey),suffixHtml:L(e,U.value,void 0,[B.labelKey])}))}}let Z=M(()=>{let e=ve.value.reduce((e,t)=>{let{item:n,matches:r}=t;return n.group?(e[n.group]||=[],e[n.group]?.push({...n,matches:r}),e):e},{}),t=Object.entries(e).map(([e,t])=>{let n=Y.value?.find(t=>t.id===e);if(n)return X(n,t)}).filter(e=>!!e);return(Y.value?.map((e,t)=>({...e,index:t}))?.filter(e=>e.ignoreFilter&&e.items?.length)?.map(e=>({...X(e,e.items||[]),index:e.index}))||[]).reduce((e,t)=>(e.splice(t.index,0,t),e),[...t])}),Q=le(`listboxRootRef`);function ye(e){e.children?.length&&(J.value.push({id:`history-${J.value.length}`,label:e.label,slot:e.slot,placeholder:e.placeholder,items:e.children}),U.value=``,Q.value?.highlightFirstItem())}function $(){J.value.length&&(J.value.pop(),U.value=``,Q.value?.highlightFirstItem())}function be(){U.value||$()}function xe(e,t){t.children?.length?(e.preventDefault(),ye(t)):t.onSelect?.(e)}return(s,c)=>(f(),l(P(i),h(P(me),{ref_key:`listboxRootRef`,ref:Q,class:K.value.root({class:[B.ui?.root,B.class]})}),{default:k(()=>[T(P(e),{modelValue:U.value,"onUpdate:modelValue":c[1]||=e=>U.value=e,"as-child":``},{default:k(()=>[T(pe,h({placeholder:ge.value,variant:`none`,autofocus:p.autofocus},P(he),{icon:p.icon||P(G).ui.icons.search,class:K.value.input({class:B.ui?.input}),onKeydown:se(be,[`backspace`])}),ee({_:2},[J.value?.length&&(p.back||H.back)?{name:`leading`,fn:k(()=>[m(s.$slots,`back`,{ui:K.value},()=>[T(S,h({icon:p.backIcon||P(G).ui.icons.arrowLeft,color:`neutral`,variant:`link`,"aria-label":P(W)(`commandPalette.back`)},typeof p.back==`object`?p.back:{},{class:K.value.back({class:B.ui?.back}),onClick:$}),null,16,[`icon`,`aria-label`,`class`])])]),key:`0`}:void 0,p.close||H.close?{name:`trailing`,fn:k(()=>[m(s.$slots,`close`,{ui:K.value},()=>[p.close?(f(),l(S,h({key:0,icon:p.closeIcon||P(G).ui.icons.close,color:`neutral`,variant:`ghost`,"aria-label":P(W)(`commandPalette.close`)},typeof p.close==`object`?p.close:{},{class:K.value.close({class:B.ui?.close}),onClick:c[0]||=e=>V(`update:open`,!1)}),null,16,[`icon`,`aria-label`,`class`])):A(``,!0)])]),key:`1`}:void 0]),1040,[`placeholder`,`autofocus`,`icon`,`class`])]),_:3},8,[`modelValue`]),T(P(n),{class:N(K.value.content({class:B.ui?.content}))},{default:k(()=>[Z.value?.length?(f(),y(`div`,{key:0,role:`presentation`,class:N(K.value.viewport({class:B.ui?.viewport}))},[(f(!0),y(b,null,O(Z.value,e=>(f(),l(P(r),{key:`group-${e.id}`,class:N(K.value.group({class:B.ui?.group}))},{default:k(()=>[P(_)(e,B.labelKey)?(f(),l(P(o),{key:0,class:N(K.value.label({class:B.ui?.label}))},{default:k(()=>[g(j(P(_)(e,B.labelKey)),1)]),_:2},1032,[`class`])):A(``,!0),(f(!0),y(b,null,O(e.items,(n,r)=>(f(),l(P(t),{key:`group-${e.id}-${r}`,value:P(te)(n,[`matches`,`group`,`onSelect`,`labelHtml`,`suffixHtml`,`children`]),disabled:n.disabled,"as-child":``,onSelect:e=>xe(e,n)},{default:k(()=>[T(ce,h({ref_for:!0},P(re)(n),{custom:``}),{default:k(({active:t,...i})=>[T(C,h({ref_for:!0},i,{class:K.value.item({class:[B.ui?.item,n.ui?.item,n.class],active:t||n.active})}),{default:k(()=>[m(s.$slots,n.slot||e.slot||`item`,{item:n,index:r},()=>[m(s.$slots,n.slot?`${n.slot}-leading`:e.slot?`${e.slot}-leading`:`item-leading`,{item:n,index:r},()=>[n.loading?(f(),l(u,{key:0,name:p.loadingIcon||P(G).ui.icons.loading,class:N(K.value.itemLeadingIcon({class:[B.ui?.itemLeadingIcon,n.ui?.itemLeadingIcon],loading:!0}))},null,8,[`name`,`class`])):n.icon?(f(),l(u,{key:1,name:n.icon,class:N(K.value.itemLeadingIcon({class:[B.ui?.itemLeadingIcon,n.ui?.itemLeadingIcon],active:t||n.active}))},null,8,[`name`,`class`])):n.avatar?(f(),l(ie,h({key:2,size:n.ui?.itemLeadingAvatarSize||B.ui?.itemLeadingAvatarSize||K.value.itemLeadingAvatarSize()},{ref_for:!0},n.avatar,{class:K.value.itemLeadingAvatar({class:[B.ui?.itemLeadingAvatar,n.ui?.itemLeadingAvatar],active:t||n.active})}),null,16,[`size`,`class`])):n.chip?(f(),l(fe,h({key:3,size:n.ui?.itemLeadingChipSize||B.ui?.itemLeadingChipSize||K.value.itemLeadingChipSize(),inset:``,standalone:``},{ref_for:!0},n.chip,{class:K.value.itemLeadingChip({class:[B.ui?.itemLeadingChip,n.ui?.itemLeadingChip],active:t||n.active})}),null,16,[`size`,`class`])):A(``,!0)]),n.labelHtml||P(_)(n,B.labelKey)||H[n.slot?`${n.slot}-label`:e.slot?`${e.slot}-label`:`item-label`]?(f(),y(`span`,{key:0,class:N(K.value.itemLabel({class:[B.ui?.itemLabel,n.ui?.itemLabel],active:t||n.active}))},[m(s.$slots,n.slot?`${n.slot}-label`:e.slot?`${e.slot}-label`:`item-label`,{item:n,index:r},()=>[n.prefix?(f(),y(`span`,{key:0,class:N(K.value.itemLabelPrefix({class:[B.ui?.itemLabelPrefix,n.ui?.itemLabelPrefix]}))},j(n.prefix),3)):A(``,!0),v(`span`,{class:N(K.value.itemLabelBase({class:[B.ui?.itemLabelBase,n.ui?.itemLabelBase],active:t||n.active})),innerHTML:n.labelHtml||P(_)(n,B.labelKey)},null,10,R),v(`span`,{class:N(K.value.itemLabelSuffix({class:[B.ui?.itemLabelSuffix,n.ui?.itemLabelSuffix],active:t||n.active})),innerHTML:n.suffixHtml||n.suffix},null,10,z)])],2)):A(``,!0),v(`span`,{class:N(K.value.itemTrailing({class:[B.ui?.itemTrailing,n.ui?.itemTrailing]}))},[m(s.$slots,n.slot?`${n.slot}-trailing`:e.slot?`${e.slot}-trailing`:`item-trailing`,{item:n,index:r},()=>[n.children&&n.children.length>0?(f(),l(u,{key:0,name:p.trailingIcon||P(G).ui.icons.chevronRight,class:N(K.value.itemTrailingIcon({class:[B.ui?.itemTrailingIcon,n.ui?.itemTrailingIcon]}))},null,8,[`name`,`class`])):n.kbds?.length?(f(),y(`span`,{key:1,class:N(K.value.itemTrailingKbds({class:[B.ui?.itemTrailingKbds,n.ui?.itemTrailingKbds]}))},[(f(!0),y(b,null,O(n.kbds,(e,t)=>(f(),l(ue,h({key:t,size:n.ui?.itemTrailingKbdsSize||B.ui?.itemTrailingKbdsSize||K.value.itemTrailingKbdsSize()},{ref_for:!0},typeof e==`string`?{value:e}:e),null,16,[`size`]))),128))],2)):e.highlightedIcon?(f(),l(u,{key:2,name:e.highlightedIcon,class:N(K.value.itemTrailingHighlightedIcon({class:[B.ui?.itemTrailingHighlightedIcon,n.ui?.itemTrailingHighlightedIcon]}))},null,8,[`name`,`class`])):A(``,!0)]),n.children?.length?A(``,!0):(f(),l(P(a),{key:0,"as-child":``},{default:k(()=>[T(u,{name:p.selectedIcon||P(G).ui.icons.check,class:N(K.value.itemTrailingIcon({class:[B.ui?.itemTrailingIcon,n.ui?.itemTrailingIcon]}))},null,8,[`name`,`class`])]),_:2},1024))],2)])]),_:2},1040,[`class`])]),_:2},1040)]),_:2},1032,[`value`,`disabled`,`onSelect`]))),128))]),_:2},1032,[`class`]))),128))],2)):(f(),y(`div`,{key:1,class:N(K.value.empty({class:B.ui?.empty}))},[m(s.$slots,`empty`,{searchTerm:U.value},()=>[g(j(U.value?P(W)(`commandPalette.noMatch`,{searchTerm:U.value}):P(W)(`commandPalette.noData`)),1)])],2))]),_:3},8,[`class`]),H.footer?(f(),y(`div`,{key:0,class:N(K.value.footer({class:B.ui?.footer}))},[m(s.$slots,`footer`,{ui:K.value})],2)):A(``,!0)]),_:3},16,[`class`]))}};export{B as default};
//# sourceMappingURL=BW1vfH5O.js.map